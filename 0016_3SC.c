#include <stdio.h>
#include <stdlib.h>
void q_sort(int *nums, int low, int high);
int threeSumClosest(int* nums, int numsSize, int target);
void q_sort(int *nums, int low, int high){
	int j,k;
	int temp;

	if (low >= high){
		return;
	}
	temp = nums[low];
	j = low;
	k = high;
	while( j< k){
		while(j < k && nums[k] >= temp){--k;}
		if(j < k){
			nums[j] = nums[k];
			++j;
		}
		while(j < k && nums[j] <= temp){++j;}
		if(j < k){
			nums[k] = nums[j];
			--k;
		}
	}
	nums[j] = temp;
	q_sort(nums,low,j-1);
	q_sort(nums,k+1,high);
}
int get_closest_sum(int old_sum,int new_sum,int target){
	int os = old_sum - target;
	int ns = new_sum - target;

	if(os < 0){
		os = -os;
	}
	if(ns < 0){
		ns = -ns;
	}
	if(ns < os){
		old_sum = new_sum;
	}
	return old_sum;
}
int threeSumClosest(int* nums, int numsSize, int target){
	int i,j,k;
	int ret;
	int sum;	

	q_sort(nums,0,numsSize-1);

	ret = nums[0] + nums[1] + nums[2];
	for(i = 0; i < numsSize-2; ++i){
		if(i>0&& nums[i-1] == nums[i]){
			continue;
		}
		j = i+1;
		k = numsSize-1;
		while(j < k){
			sum = nums[i] + nums[j] + nums[k];
			if(sum == target){
				return sum;
			}else if(sum > target){
				// 总数大就减小k;
				while(--k > j && nums[k] == nums[k+1]){}
			}
			else{
				while(++j < k && nums[j] == nums[j-1]){}
			}
			ret = get_closest_sum(ret,sum,target);
		}

	}
	return ret;
}
int main(){
	int nums[4] = {-1,2,1,-4};
//	int nums[3] = {0,0,0};
//	int nums[] = {-43,57,-71,47,3,30,-85,6,60,-59,0,-46,-40,-73,53,68,-82,-54,88,73,20,-89,-22,39,55,-26,95,-87,-57,-86,28,-37,43,-27,-24,-88,-35,82,-3,39,-85,-46,37,45,-24,35,-49,-27,-96,89,87,-62,85,-44,64,78,14,59,-55,-10,0,98,50,-75,11,97,-72,85,-68,-76,44,-12,76,76,8,-75,-64,-57,29,-24,27,-3,-45,-87,48,10,-13,17,94,-85,11,-42,-98,89,97,-66,66,88,-89,90,-68,-62,-21,2,37,-15,-13,-24,-23,3,-58,-9,-71,0,37,-28,22,52,-34,24,-8,-20,29,-98,55,4,36,-3,-9,98,-26,17,82,23,56,54,53,51,-50,0,-15,-50,84,-90,90,72,-46,-96,-56,-76,-32,-8,-69,-32,-41,-56,69,-40,-25,-44,49,-62,36,-55,41,36,-60,90,37,13,87,66,-40,40,-35,-11,31,-45,-62,92,96,8,-4,-50,87,-17,-64,95,-89,68,-51,-40,-85,15,50,-15,0,-67,-55,45,11,-80,-45,-10,-8,90,-23,-41,80,19,29,7};
//	int nums[] = {-54,-752,288,674,-670,202,240,756,321,798,-154,689,-549,542,-980,-711,305,-862,-42,867,-308,-867,-205,312,371,-47,448,698,-541,91,-751,-540,-873,-340,-484,-352,776,425,701,-194,-482,880,-163,486,-929,673,-431,539,-415,-889,415,-700,818,-2,896,212,794,-743,405,-377,-302,784,-372,917,35,850,-279,-365,294,120,716,-543,760,-613,353,-953,-684,-200,155,977,-876,-74,103,507,680,837,-783,-828,-303,-691,-427,-740,-376,-190,899,264,113,-358,123,773,-380,309,-656,593,185,-516,765,904,363,-367,-460,617,-361,-605,-76,230,-96,-164,-928,-301,374,-328,-941,-685,-765,-538,328,-111,-523,908,-218,-145,-199,11,348,705,-682,6,344,-964,-112,632,-255,-882,713,572,-997,976,614,-527,992,-504,525,-993,-99,566,10,44,-409,152,439,-130,137,940,-175,558,885,313,989,261,-52,338,144,-856,-631,-927,112,918,-563,-689,-868,36,-842,-148,-180,310,-981,129,-213,505,-463,-128,269,-560,-317,62,332,943,245,-3,-429,946,-261,59,89,477,571,-404,-212,-580,-147,278,996,281,855,-849,-725,779,-138,-723,866,286,-570,-299,-638,403,985,411,429,277,-782,-522,84,-673,-442,341,299,963,-650,-425,-453,-975,-737,-381,316,515,-30,-804,808,-300,644,-825,722,-364,-438,-132,-775,203,-643,-198,127,-201,-526,175,750,-785,-573,46,556,389,82,788,-730,-860,790,-658,188,-945,-869,-554,753,259,-850,489,60,-786,-242,-595,-258,-984,74,534,-503,907,-731,-346,530,-619,646,-329,227,-692,-473,56,-487,164,582,527,-865,738,-651,-738,-501,-265,201,-268,-4,590,-354,-771,-274,-245,799,-188,-932,-963,-80,898,449,994,-222,526,-962,-191,61,213,657,813,-557,883,-336,-512,649,-815,454,-930,-871,359,-71,-874,-807,771,759,291,524,-229,257,66,-356,-151,685,17,987,96,-799,-559,-159,-64,787,143,914,789,70,159,-75,-641,804,-240,959,-403,851,-450,481,267,-690,-424,840,893,-566,-140,432,-182,73,-896,-531,565,-298,114,735,-832,303,-859,-976,-38,-9,-472,-166,800,-120,580,109,653,801,406,826,-343,546,252,491,755,-114,950,424,-494,-988,-659,-942,340,468,487,504,912,-430,-388,-693,-333,803,-142,27,106,604,1,-629,57,-617,-906,934,-122,-65,682,475,287,-902,-544,-77,845,-770,488,537,715,-576,282,58,761,-405,-94,520,821,360,-470,-327,937,-244,-853,631,141,-239,570,603,254,19,-284,-156,-22,926,-247,-186,495,158,-939,861,382,595,-310,894,-66,605,48,-456,660,547,503,49,-745};
	//int target = 255;
	int target = 1;
	//int target = 6888;
	int ret;

	ret = threeSumClosest(nums,sizeof(nums)/sizeof(int),target);
	printf("%d\n",ret);
	return 0;
}

